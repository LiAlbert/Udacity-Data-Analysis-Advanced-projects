<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://dimplejs.org/dist/dimple.v2.0.0.min.js"></script>
  <style>

      div.type_buttons {
        position:fixed;
        top:200px;
        left:0px;
      }

      div.type_buttons {
        background-color: rgb(251, 201, 127);
        padding: 3px;
        margin: 7px;

      }



  </style>
  <script type="text/javascript">



    function draw(data) {


      d3.select("body")
        .append("h1")
        .text("Survival Chance on the Titanic");

      //set canvas
      "use strict";
      var margin = 75,
        width = 1400 - margin,
        height = 600 - margin;

      var svg = d3.select("body")
        .append("svg")
        .attr("width", width + margin)
        .attr("height", height + margin)
        .append('g')
        .attr('class', 'chart');

        //draw initial chart
        var data_draw = dimple.filterData(data, "type", "all");
        var myChart = new dimple.chart(svg, data_draw);
        var x = myChart.addCategoryAxis("x", "category");
        myChart.addMeasureAxis("y", "percentage");
        myChart.addSeries(null, dimple.plot.bar);
        myChart.draw();

        function update(t) {
          svg.selectAll("*").remove();
          var data_draw = dimple.filterData(data, "type", t);
          var myChart = new dimple.chart(svg, data_draw);
          var x = myChart.addCategoryAxis("x", "category");
          myChart.addMeasureAxis("y", "percentage");
          myChart.addSeries(null, dimple.plot.bar);
          myChart.draw();


        }


      var button_labels = ["all", "sex", "age"];


      var buttons = d3.select("body")
                      .append("div")
                      .attr("class", "type_buttons")
                      .selectAll("div")
                      .data(button_labels)
                      .enter()
                      .append("div")
                      .text(function(d) {return d;});

       buttons.on("click", function(d) {
                             d3.select(".type_buttons")
                               .selectAll("div")
                               .transition()
                               .duration(100)
                               .style("color", "black")
                               .style("background", "rgb(251, 201, 127)");

                             d3.select(this)
                               .transition()
                               .duration(100)
                               .style("background", "lightBlue")
                               .style("color", "white");


                               update(d);

                           });


    };
  </script>
</head>

<body>
  <script type="text/javascript">

      d3.csv("Titanic.csv", draw);

  </script>
</body>

</html>
