<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://dimplejs.org/dist/dimple.v2.0.0.min.js"></script>
  <style>

      div.type_buttons {
        position:fixed;
        top:200px;
        left:730px;
      }

      div.type_buttons {
        background-color: rgb(251, 201, 127);
        padding: 3px;
        margin: 7px;

      }

      h1 {
        text-align: left;
        color:black;
      }

      h2 {
        text-align: center;
        color:black;
      }



  </style>


  <script type="text/javascript">



    function draw(data) {

      d3.select("body")
        .append("h1")
        .text("Who survived from Titanic?");

      d3.select("body")
          .append("h2")
          .text("all");

      //set canvas
      "use strict";
      var margin = 75,
        width = 800 - margin,
        height = 500 - margin;

      var svg = d3.select("body")
        .append("svg")
        .attr("width", width + margin)
        .attr("height", height + margin)
        .append('g')
        .attr('class', 'chart');



        //draw initial chart
        var data_draw = dimple.filterData(data, "type", "all");
        var myChart = new dimple.chart(svg, data_draw);
        var x = myChart.addCategoryAxis("x", "category");
        x.fontSize = "15px";
        var y = myChart.addMeasureAxis("y", "percentage");
        y.overrideMax = 1;
        y.fontSize = "15px";
        y.tickFormat = "%";
        myChart.addSeries(null, dimple.plot.bar);
        myChart.draw();

        // according to button, update bar plot contents
        function update(t) {
          //update title
          d3.select("h2")
            .text(t);
          //update chart
          svg.selectAll("*").remove();
          var data_draw = dimple.filterData(data, "type", t);
          var myChart = new dimple.chart(svg, data_draw);
          var x = myChart.addCategoryAxis("x", "category");
          x.fontSize = "15px";
          var y = myChart.addMeasureAxis("y", "percentage");
          y.overrideMax = 1;
          y.fontSize = "15px";
          y.tickFormat = "%";
          myChart.addSeries(null, dimple.plot.bar);
          myChart.draw();


        }






      var button_labels = ["all", "sex", "age", "class", "class+female", "class+male"];


      var buttons = d3.select("body")
                      .append("div")
                      .attr("class", "type_buttons")
                      .selectAll("div")
                      .data(button_labels)
                      .enter()
                      .append("div")
                      .text(function(d) {return d;});

       buttons.on("click", function(d) {
                             d3.select(".type_buttons")
                               .selectAll("div")
                               .transition()
                               .duration(100)
                               .style("color", "black")
                               .style("background", "rgb(251, 201, 127)");

                             d3.select(this)
                               .transition()
                               .duration(100)
                               .style("background", "lightBlue")
                               .style("color", "white");


                               update(d);

                           });


    };
  </script>
</head>

<body>
  <script type="text/javascript">

      d3.csv("Titanic.csv", draw);

  </script>
</body>

</html>
